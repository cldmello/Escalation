{% extends 'base.html' %}

{% block header %}
 <h1>{% block title %}Crank Administration{% endblock %}</h1>
{% endblock %}

 {% block content %}

<h2>Crank records</h2>
<form method="post">
  <div style="max-width:800px;">
  <table id="crank_table" class="compact hover order-column row-border" style="width:100%;">
    <thead>
   <tr>
     <th>Crank </th>
     <th>Git commit </th>     
     <th>Number Runs</th>
     <th>Uploader </th>
     <th>Timestamp </th>
     <th>Active / Inactive</th>     
   </tr>
    </thead>
    <tbody>
  {% for r in cranks %}
   <tr>
     <td> {{ r['crank'] }} </td>
     <td> {{ r['githash'] }} </td>    
     <td> {{ r['num_runs'] }} </td>        
     <td> {{ r['username'] }} </td>
     <td> {{ r['created'].strftime("%Y-%m-%d %H:%M:%S") }} </td>
     <td data-order="{{ r['active'] }}">
       <input type="radio" name="{{ r['id']}}" value="active" {% if r['active'] %} checked="checked"{% endif %}>
       <input type="radio" name="{{ r['id']}}" value="not_active" {% if not r['active']  %} checked="checked"{% endif %}>
     </td>         
   </tr>
   {% endfor %}
    </tbody>   
  </table>
  
<script>
$(document).ready(function() {
$('#crank_table').DataTable( {
        "order": [[ 0, "desc" ]],
  }
  );
  } );

</script>
  
  
  <label for="adminkey">Admin code</label>  
  <input type="text" name="adminkey" required>
  
  <input type="submit" value="Update active cranks" name="submit">
  </div>
</form>

<h2>Upload new stateset csv </h2>
 
<pre>python3 escalation/submit_server/scripts/upload_stateset.py</pre>
</form>  

<h2>Chemical Database</h2>

<form method="post" id="chem_form">
  <table id="chem_table">
    <thead>
      <th>Delete</th>
      <th>INCHI key</th>
      <th>Chemical Name</th>
      <th>Abbreviation</th>
    </thead>
    <tbody>
      {% for chem in chem_table %}
      <input type="hidden" name="id" value="{{ chem['id'] }}">
      <tr>
        <td> <input type="checkbox" name="delete" value="{{ chem['id'] }}"></td>
        <td> <input class="chem_text" size="40" type="text" name="inchi" value="{{ chem['inchi'] }}" required></td>
        <td> <input class="chem_text" size="30" type="text" name="common_name" value="{{ chem['common_name'] }}" required> </td>
        <td> <input class="chem_text" size="20" type="text" name="abbrev" value="{{ chem['abbrev'] }}" required> </td>
      </tr>
      {% endfor %}
      <tr>
        <td></td>        
        <td> <input class="chem_text" size="40" type="text" name="inchi" placeholder="New INCHI key"></td>
        <td> <input class="chem_text" size="30" type="text" name="common_name" placeholder="Common Name"> </td>
        <td> <input class="chem_text" size="20" type="text" name="abbrev" placeholder="Abbreviation"> </td>
      </tr>
    </tbody>
  </table>

  <label for="adminkey">Admin code</label>  
  <input type="text" name="adminkey" required>
  
  <input type="submit" value="Update Chemical Names" name="submit">
    
</form>  
 <h2>Development commands for database</h2>
 <form method="post">
  <label>
    <input type="radio" name="db" value="reset">Clear DB
  </label>

  <label for="adminkey">Admin code</label>  
  <input type="text" name="adminkey" required>
  
  <input type="submit" value="Update Database" name="submit"  >
 </form>

 <p><a href="https://gitlab.sd2e.org/sd2program/versioned-datasets">Versioned Data Repo</a></p> 
 <p><a href="https://gitlab.sd2e.org/sd2program/test-harness/tree/master/harness">Test Harness Repository</a></p>
 <p><a href="http://jenkins.sd2e.org/job/versioned_data_pipeline">Jenkins Versioned Data</a></p>

{% endblock %}
