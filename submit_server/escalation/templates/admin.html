{% extends 'base.html' %}

{% block header %}
 <h1>{% block title %}Current Crank Administration{% endblock %}</h1>
{% endblock %}

 {% block content %}
<p> Add new crank configuration </p>
<p>CSV format is "dataset,name,_rxn_M_inorganic,_rxn_M_organic"</p>
   <form method="post" enctype="multipart/form-data">

     {% if 'crank' in session %}
     <label for="csvfile">CSV file</label>
     <input type="file" name="csvfile" accept="csv" required>
     
     <label for="gitcommit">Git commit</label>  
     <input type="text" name="gitcommit" value="{{ session['gitcommit'] }}" maxlength="7" required>

     <label for="admincode">Admin code</label>  
     <input type="text" name="admincode" value="{{ session['admincode'] }}" required>
     
     {% else %}
     <label for="csvfile">CSV file</label>
     <input type="file" name="csvfile" accept="csv" required>
     
     <label for="gitcommit">Git commit</label>  
     <input type="text" name="gitcommit" maxlength="7" required>
  
     <label for="admincode">Admin code</label>  
     <input type="text" name="admincode" required>

     {% endif %}
  <input type="submit" value="Update current crank">
 </form>

 <p> Ten most recent crank records </p>
 <table style="min-width:720px">
  <tr>
   <th> Crank </th>
   <th> Stateset Hash </th>
   <th> Git commit </th>   
   <th> Timestamp </th>
  </tr>
  {% for r in cranks[:10] %}
  <tr>
   <td> {{ r['crank'] }} </td>
   <td> {{ r['stateset'] }} </td>
   <td> {{ r['gitcommit'] }} </td>   
   <td> {{ r['created'].strftime("%Y-%m-%d %H:%M:%S") }} </td>
   {% if r['Current'] == 'TRUE' %}
   <td> <b> Current </b> </td>
   {% endif %}
  </tr>

  {% endfor %}

 </table>
{% endblock %}
