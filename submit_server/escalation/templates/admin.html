{% extends 'base.html' %}

{% block header %}
 <h1>{% block title %}Crank Administration{% endblock %}</h1>
{% endblock %}

 {% block content %}

<h1> Ten most recent crank records </h1>
<form method="post">   
 <table style="min-width:720px">
   <tr>
     <th></th>
   <th>Crank </th>
   <th>Stateset Hash </th>
   <th>Number Runs</th>
   <th>Git commit </th>
   <th>Uploader </th>
   <th>Timestamp </th>
  </tr>
  {% for r in cranks[:10] %}
   <tr>
    <td> <input type="radio" name="new_stateset" value="{{ r['id'] }}" > </td>    
   <td> {{ r['crank'] }} </td>
   <td> {{ r['stateset'] }} </td>
   <td> {{ r['num_runs'] }} </td>        
   <td> {{ r['githash'] }} </td>
   <td> {{ r['username'] }} </td>
   <td> {{ r['created'].strftime("%Y-%m-%d %H:%M:%S") }} </td>
   {% if r['current'] == True %}
   <td> <b> Current </b> </td>
   {% endif %}
  </tr>

  {% endfor %}
 </table>
  <label for="adminkey">Admin code</label>  
  <input type="text" name="adminkey" required>
  
 <input type="submit" value="Roll back Stateset" name="submit">
</form>

<h1> Upload new stateset csv </h1>
 
<pre>python3 escalation/submit_server/scripts/upload_stateset.py  path_to_versioned_repo </pre>
</form>  

 <h1>Development commands for database</h1>
 <form method="post">
  <label>
    <input type="radio" name="db" value="demo">Reset DB with test data
  </label>
  <label>
    <input type="radio" name="db" value="reset">Clear DB
  </label>

  <label for="adminkey">Admin code</label>  
  <input type="text" name="adminkey" required>
  
  <input type="submit" value="Update Database" name="submit"  >
 </form>

 <p><a href="https://gitlab.sd2e.org/sd2program/versioned-datasets">Versioned Data Repo</a></p> 
 <p><a href="https://gitlab.sd2e.org/sd2program/test-harness/tree/master/harness">Test Harness Repository</a></p>
 <p><a href="http://jenkins.sd2e.org/job/versioned_data_pipeline">Jenkins Versioned Data</a></p>
 
{% endblock %}
